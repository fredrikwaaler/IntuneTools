DEFAULT_GPT_MODEL = "gpt-4o-mini-2024-07-18"
MARKDOWN_PROMPT = "Your job is to map the reccomendations in the input that belong to the specified section to markdown as below - and only those that belongs to the specified section. "\
                  "INPUT: "\
                  "    Section: 4.1.3"\
                  "    Recommendations: Page 35 1.1 (L1) Ensure 'Allow Cortana Above Lock' is set to 'Block' (Automated) Profile Applicability: • Level 1 (L1) Description: This policy setting determines whether or not the user can interact with Cortana using speech while the system is locked. The recommended state for this setting is: Block. Rationale: Access to any computer resource should not be allowed when the device is locked. Impact: The system will need to be unlocked for the user to interact with Cortana using speech. Audit: 1. Navigate to the following registry location and note the WinningProvider GUID. This value confirms under which User GUID the policy is set. HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\AboveLock:AllowCortanaAboveLock_WinningProvider 2. Navigate to the following registry location and confirm the value is set to 0. HKLM\SOFTWARE\Microsoft\PolicyManager\Providers\{GUID}\Default\Device\AboveLock:AllowCortanaAboveLock Remediation: To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Block. Above Lock\Allow Cortana Above Lock Default Value: Enabled. (The user can interact with Cortana using speech while the system is locked.) Page 36 References: 1. https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-abovelock#allowcortanaabovelock 2. Minimum OS CSP: Windows 10, Version 1607 and later 3. GRID: MS-00000510 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software Uninstall or disable unnecessary services on enterprise assets and software, such as an unused file sharing service, web application module, or service function. ● ● v7 16.11 Lock Workstation Sessions After Inactivity Automatically lock workstation sessions after a standard period of inactivity. ● ● ● Page 37 2 Account Management This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 3 Accounts This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 4 Administrative Templates This section contains recommendations for Administrative Templates. 4.1 Control Panel This section contains recommendations for Control Panel. 4.1.1 Add or Remove Programs This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 4.1.2 Display This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 4.1.3 Personalization This section contains recommendations for Personalization. Page 38 4.1.3.1 (L1) Ensure 'Prevent enabling lock screen camera' is set to 'Enabled' (Automated) Profile Applicability: • Level 1 (L1) Description: Disables the lock screen camera toggle switch in PC Settings and prevents a camera from being invoked on the lock screen. The recommended state for this setting is: Enabled. Rationale: Disabling the lock screen camera extends the protection afforded by the lock screen to camera features. Impact: If you enable this setting, users will no longer be able to enable or disable lock screen camera access in PC Settings, and the camera cannot be invoked on the lock screen. Audit: Navigate to the UI Path articulated in the Remediation section and confirm it is set as prescribed. This policy setting is backed by the following registry location with a REG_DWORD value of 1. HKLM\SOFTWARE\Policies\Microsoft\Windows\Personalization:NoLockScreenCamera Remediation: To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled. Administrative Templates\Control Panel\Personalization\Prevent enabling lock screen camera Default Value: Disabled. (Users can enable invocation of an available camera on the lock screen.) References: 1. https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-devicelock#preventenablinglockscreencamera 2. GRID: MS-00000231 3. Minimum OS CSP: Windows 10, version 1803 and later Page 39 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 0.0 Explicitly Not Mapped Explicitly Not Mapped v7 16.11 Lock Workstation Sessions After Inactivity Automatically lock workstation sessions after a standard period of inactivity. ● ● ● Page 40 4.1.3.2 (L1) Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled' (Automated) Profile Applicability: • Level 1 (L1) Description: Disables the lock screen slide show settings in PC Settings and prevents a slide show from playing on the lock screen. The recommended state for this setting is: Enabled. Rationale: Disabling the lock screen slide show extends the protection afforded by the lock screen to slide show contents. Impact: If you enable this setting, users will no longer be able to modify slide show settings in PC Settings, and no slide show will ever start. Audit: Navigate to the UI Path articulated in the Remediation section and confirm it is set as prescribed. This policy setting is backed by the following registry location with a REG_DWORD value of 1. HKLM\SOFTWARE\Policies\Microsoft\Windows\Personalization:NoLockScreenSlideshow Remediation: To establish the recommended configuration via configuration profiles, set the following Settings Catalog path to Enabled. Administrative Templates\Control Panel\Personalization\Prevent enabling lock screen slide show Default Value: Disabled. (Users can enable a slide show that will run after they lock the machine.) References: 1. https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-devicelock#preventlockscreenslideshow 2. GRID: MS-00000232 3. Minimum OS CSP: Windows 10, version 1703 and later Page 41 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 0.0 Explicitly Not Mapped Explicitly Not Mapped v7 16.11 Lock Workstation Sessions After Inactivity Automatically lock workstation sessions after a standard period of inactivity. ● ● ● Page 42 4.1.4 Printers This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 4.1.5 Programs This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 4.1.6 Regional and Language Options This section contains recommendations for Regional and Language Options. 4.1.7 User Account This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 4.2 Desktop This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 4.3 LAPS (legacy) This section was for the legacy Microsoft LAPS, which was replaced by Windows LAPS. This section is intentionally blank and exists to ensure the structure of the Intune benchmarks are consistent. 4.4 MS Security Guide This section contains recommendations for MS Security Guide."\
                  "\n\n OUTPUT: "\
                  "| **Recommendation**                                                                 | **CIS Reference** | **Type** | **Origin** | **Followed**                                                                                                                                                | **Notes** | **Intune Policy ** | **Link**     | **References** |"\
                  "|------------------------------------------------------------------------------------|-------------------|----------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|--------------------|--------------|----------------|"\
                  "| Ensure 'Prevent enabling lock screen camera' is set to 'Enabled' | 4.1.3.1 | Automated | CIS | Yes | -  |-  | - | [References](https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-devicelock#preventenablinglockscreencamera) |"\
                  "| Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'   | 4.1.3.2 | Automated | CIS  | Yes | - | - | - | [References](https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-devicelock#preventlockscreenslideshow) "\
                  "| Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled | 4.4.1             | Automated | CIS      | Yes | -   | -      | Link    | [References](https://learn.microsoft.com/en-us/windows/security/identity-protection/access-control/local-accounts) |"\
                  "As you can see 'reccomendation' should have the bare name of the rec, CIS Reference should hold the number of the ref, Type should be automated or manual based on what is in the reccomendation,  Origin is always 'CIS', 'Followed' is always 'Yes', Notes should always be -, Intune Policy should always be blank, Link should always be '-' if the reccomendation is applied automatically, else you should try to put the link to the place in the portal where you can apply the rec. and references should be a link to the first reference under the reccomendaiton in the pdf - unless there is none, then it should be '-' "